{# Extracted modal About Me body #}
<div class="pointer-events-none absolute inset-0 opacity-45 mix-blend-normal z-0 bg-[radial-gradient(circle_at_22%_18%,#E5F4F2,transparent_55%),radial-gradient(circle_at_82%_74%,#FFDDD0,transparent_62%)]"></div>
<div class="flex items-start gap-4 flex-wrap relative z-10"
    x-data="{ hasVideo: ($store.profileModal.therapist.video_gallery && $store.profileModal.therapist.video_gallery.length) }"
    x-init="$watch('$store.profileModal.therapist.video_gallery', v => hasVideo = (v && v.length))">
  <div class="flex flex-col gap-1 mb-4" :class="!hasVideo ? 'mb-2' : 'mb-4'">
    <h2 class="text-[22px] md:text-[24px] font-extrabold tracking-tight text-[#2e4a49] flex items-center gap-2">
      <svg class="w-7 h-7 text-[#116466]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5Z"/><path stroke-linecap="round" stroke-linejoin="round" d="M3.5 22c1.4-3.9 5-6.5 8.5-6.5s7.1 2.6 8.5 6.5"/></svg>
      About Me
    </h2>
    <p class="text-[11px] font-medium tracking-wide text-[#587a79] uppercase">Share connection, values & style</p>
  </div>
</div>
<!-- Intro Video (modal first) unified editable block (now boxed like gallery). Wrapper ends BEFORE personal statements. -->
<div class="mb-8 rounded-xl p-4 md:p-5 bg-white/75 ring-1 ring-[#BEE3DB] shadow-sm flex flex-col gap-4 relative overflow-hidden"
    x-data="(typeof videoManager==='function') ? videoManager() : {}"
    x-init="if(!video){ const vg=Alpine.store('profileModal')?.therapist?.video_gallery||[]; if(vg.length) video=vg[0]; } $watch('$store.profileModal.therapist.video_gallery', v => { if(v && v.length){ video = v[0]; } else { if(!recording && !file) video=null; } });"
    {% if editable %}data-editable="1"{% endif %}>
  <div class="absolute inset-0 pointer-events-none opacity-35 bg-[radial-gradient(circle_at_18%_22%,#E5F4F2,transparent_58%),radial-gradient(circle_at_82%_78%,#FFDDD0,transparent_65%)]"></div>
  <div class="relative z-10">
  <div class="flex items-center gap-3 mb-2">
    <h3 class="text-xl font-semibold text-[#555B6E]">Intro Video</h3>
    <span class="text-[11px] font-medium text-[#89B0AE]" x-text="video ? '1 / 1' : '0 / 1'"></span>
  </div>
  <!-- If video exists show display/edit -->
  <div class="w-full md:w-72 flex flex-col gap-4" x-show="video" x-cloak>
    <div class="rounded-xl overflow-hidden bg-black aspect-video relative" x-data="{ }">
  <video x-show="video && !videoLoadError" :src="video && video.video_url ? video.video_url : ''" controls playsinline class="w-full h-full object-cover" @error="videoLoadError=true; console.warn('Intro video failed to load');" @loadeddata="videoLoadError=false"></video>
      <template x-if="videoLoadError">
        <div class="absolute inset-0 flex flex-col items-center justify-center gap-3 bg-black/70 text-white text-xs p-3 text-center">
          <p class="font-medium">Video failed to load.</p>
          {% if editable %}
          <button type="button" @click="video=null; videoLoadError=false;" class="px-3 py-1.5 rounded-full bg-white text-[#116466] text-[11px] font-semibold hover:bg-[#E5F4F2]">Re-upload</button>
          {% endif %}
        </div>
      </template>
    </div>
    <template x-if="video">
      <textarea x-model="video.caption" @change="updateCaption()" maxlength="128" placeholder="Caption" class="w-full rounded-md border border-[#BEE3DB] bg-white px-3 py-2 text-[12px] focus:border-[#116466] focus:ring-[#116466]"></textarea>
    </template>
    {% if editable %}
    <div class="flex gap-2" x-show="video" x-cloak>
      <button type="button" @click="openDelete()" class="px-3 py-2 rounded-full bg-[#FFE8E5] text-[#9b4d49] text-xs font-semibold hover:bg-[#FFD5CF]">Delete</button>
    </div>
    {% endif %}
  </div>
  <!-- If no video show upload/record UI (edit mode only) -->
  {% if editable %}
  <div x-show="!video" x-cloak class="w-full">
    <div class="flex flex-col md:flex-row gap-6 items-start">
      <!-- Left: Upload & Record Column -->
      <div class="flex-1 flex flex-col gap-4 max-w-full md:max-w-md">
        <div class="relative border-2 border-dashed rounded-xl p-5 flex flex-col items-center justify-center text-center gap-3 bg-white/80"
             :class="drag ? 'border-[#116466] bg-[#E5F4F2]/60' : 'border-[#BEE3DB]'"
             @dragover.prevent="drag=true" @dragleave.prevent="drag=false" @drop.prevent="drag=false; const f=$event.dataTransfer?.files?.[0]; if(f) setFile(f);">
          <svg class="w-10 h-10 text-[#116466]" fill="none" stroke="currentColor" stroke-width="1.6" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v12m0 0 4-4m-4 4-4-4M4 16.5a4.5 4.5 0 0 1 4.5-4.5h1.118a2 2 0 0 0 1.414-.586l1.172-1.172a2 2 0 0 1 1.414-.586H15a5 5 0 0 1 5 5v1a4 4 0 0 1-4 4H8.5A4.5 4.5 0 0 1 4 16.5Z"/></svg>
          <p class="text-[12px] leading-snug text-[#2e4a49]">Drop video or <button type="button" class="underline font-semibold" @click="$refs.vidFile.click()">browse</button><br/><span class="text-[11px] text-[#89B0AE]">MP4 / WebM • ≤ 60MB</span></p>
          <input type="file" x-ref="vidFile" accept="video/mp4,video/webm" class="hidden" @change="onFile($event)" />
          <template x-if="file"><p class="text-[11px] text-[#116466] truncate max-w-[180px]" x-text="file.name"></p></template>
          <template x-if="error"><p class="text-[11px] text-[#9b4d49]" x-text="error"></p></template>
        </div>
        <div class="flex flex-wrap gap-2 items-center">
          <button type="button" @click="recording ? stopRecording() : startRecording()" class="px-3.5 py-1.5 rounded-full text-[11px] font-semibold" :class="recording ? 'bg-[#9b4d49] text-white' : 'bg-[#116466] text-white hover:bg-[#0d4c4d]'" x-text="recording ? 'Stop' : 'Record'"></button>
          <button type="button" @click="upload()" :disabled="uploading || !file" class="px-3.5 py-1.5 rounded-full text-[11px] font-semibold bg-[#116466] text-white disabled:opacity-40 disabled:cursor-not-allowed hover:bg-[#0d4c4d]">Upload</button>
          <button type="button" @click="reset()" :disabled="uploading || (!file && !recording)" class="px-3.5 py-1.5 rounded-full text-[11px] font-medium bg-white ring-1 ring-[#BEE3DB] hover:bg-[#E5F4F2] disabled:opacity-30">Clear</button>
          <template x-if="recording"><span class="flex items-center gap-1 text-[10px] font-semibold text-[#9b4d49] animate-pulse select-none"><span class="w-2 h-2 rounded-full bg-[#9b4d49]"></span>REC</span></template>
        </div>
        <div class="rounded-xl overflow-hidden bg-black aspect-video relative" x-show="recording || previewUrl" x-cloak>
          <video x-ref="livePreview" x-show="recording" autoplay playsinline muted class="w-full h-full object-cover"></video>
          <video x-show="!recording && previewUrl" :src="previewUrl" controls playsinline class="w-full h-full object-cover"></video>
          <div class="absolute top-2 left-2 flex items-center gap-2" x-show="recording"><span class="px-2 py-0.5 rounded-full bg-[#9b4d49] text-white text-[10px] font-semibold shadow">Recording…</span></div>
        </div>
        <input type="text" x-model="caption" maxlength="120" placeholder="Caption (optional)" class="w-full rounded-md border border-[#BEE3DB] bg-white px-3 py-2 text-[12px] focus:border-[#116466] focus:ring-[#116466]" />
        <template x-if="uploading"><div class="h-1 w-full bg-[#E5F4F2] rounded overflow-hidden"><div class="h-full bg-[#FF9950] animate-pulse" style="width:100%"></div></div></template>
      </div>
      <!-- Right: Helpful Hints Panel -->
      <div class="md:w-64 lg:w-72 shrink-0 rounded-2xl bg-white/95 ring-1 ring-[#BEE3DB] shadow-md px-4 py-4 md:px-5 md:py-5 backdrop-blur-sm">
        <h4 class="text-[13px] font-semibold tracking-wide text-[#116466] mb-2">Intro Video Tips</h4>
        <ul class="text-[12px] leading-relaxed text-[#2e4a49] space-y-2 list-disc pl-4">
          <li><span class="font-medium">Aim for ~45–60s:</span> focus on how clients feel working with you.</li>
          <li><span class="font-medium">Good lighting & sound:</span> face natural light; reduce background noise.</li>
          <li><span class="font-medium">Eye contact:</span> look at the camera lens to build trust.</li>
          <li><span class="font-medium">Who you help:</span> name the people / concerns you work best with.</li>
          <li><span class="font-medium">Warm close:</span> invite them to reach out for a consult.</li>
        </ul>
      </div>
    </div>
  </div>
  {% endif %}
  </div><!-- /inner content -->
  <div x-show="confirmDelete" x-cloak class="fixed inset-0 z-[7000] flex items-center justify-center" aria-modal="true" role="dialog">
    <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" @click="cancelDelete()"></div>
    <div class="relative w-full max-w-sm mx-auto bg-white rounded-2xl shadow-2xl ring-1 ring-[#BEE3DB] overflow-hidden">
      <div class="absolute inset-0 pointer-events-none opacity-60 mix-blend-normal bg-[radial-gradient(circle_at_18%_22%,#E5F4F2,transparent_60%),radial-gradient(circle_at_82%_78%,#FFDDD0,transparent_65%)]"></div>
      <div class="relative p-6 flex flex-col gap-4">
        <h3 class="text-base font-semibold text-[#555B6E]">Delete intro video?</h3>
        <p class="text-[12px] leading-relaxed text-[#2e4a49]">This will permanently remove your current intro video. You can upload a new one anytime.</p>
        <div class="flex items-center justify-end gap-3 pt-2">
          <button type="button" @click="cancelDelete()" :disabled="deleting" class="px-4 py-1.5 rounded-full bg-white ring-1 ring-[#BEE3DB] text-[#116466] text-xs font-semibold hover:bg-[#E5F4F2] disabled:opacity-50">Cancel</button>
          <button type="button" @click="confirmDeleteAction()" :disabled="deleting" class="px-4 py-1.5 rounded-full bg-[#9b4d49] text-white text-xs font-semibold hover:bg-[#873f3b] disabled:opacity-50 flex items-center gap-2">
            <span x-show="!deleting">Delete</span>
            <span x-show="deleting" class="flex items-center gap-1"><span class="w-2 h-2 rounded-full bg-white animate-pulse"></span>Deleting…</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div><!-- /video wrapper -->
<!-- Personal Statement 1 (styled like Therapy Types Note) -->
<div x-show="editable || $store.profileModal.therapist.personal_statement_q1" x-cloak>
  <div class="mb-4" data-edit-wrapper data-field="personal_statement_q1">
    <div class="relative">
      <template x-if="$store.profileModal.therapist.personal_statement_q1">
        <div class="text-sm md:text-[15px] leading-relaxed font-light text-[#2e4a49] whitespace-pre-line bg-white/70 rounded-xl border border-[#BEE3DB] p-4 pr-10" x-html="$store.profileModal.therapist.personal_statement_q1"></div>
      </template>
      <template x-if="!$store.profileModal.therapist.personal_statement_q1">
        <div>
          <button type="button" x-show="editable" @click.stop="$dispatch('edit-rich-text',{field:'personal_statement_q1',current:'', el:$el})" class="w-full text-left group">
            <div class="p-4 rounded-lg border-2 border-dashed border-[#BEE3DB] bg-white/40 hover:bg-white/70 transition">
              <p class="text-[12px] text-[#89B0AE] group-hover:text-[#555B6E]">Briefly introduce yourself, your approach, and how early sessions feel. (120–400 chars)</p>
            </div>
          </button>
          <p x-show="!editable" class="italic text-[12px] text-[#89B0AE]">No personal statement.</p>
        </div>
      </template>
      {% if editable %}
      <button type="button" class="absolute top-2 right-2 text-[10px] font-semibold px-2 py-0.5 rounded-full bg-[#E5F4F2] text-[#116466] ring-1 ring-[#BEE3DB] hover:bg-white" @click.stop="$dispatch('edit-rich-text',{field:'personal_statement_q1',current:$store.profileModal.therapist.personal_statement_q1||'', el: $el})">Edit</button>
      {% endif %}
    </div>
  </div>
  
</div>
<!-- Image Gallery (modal third) - modern compact grid -->
<div x-show="editable || ($store.profileModal.therapist.gallery_images && $store.profileModal.therapist.gallery_images.length)" x-cloak>
  {% if editable %}
  <div class="mb-10 rounded-xl p-4 md:p-5 bg-white/70 ring-1 ring-[#BEE3DB] shadow-sm flex flex-col gap-4" x-data="galleryManager()" x-init="images=(Alpine.store('profileModal')?.therapist?.gallery_images||[]).slice()" x-on:keydown.escape="confirm.show && cancelDelete()">
    <div class="flex items-center justify-between flex-wrap gap-3">
      <h3 class="text-sm font-bold tracking-wide text-[#555B6E]">Image Gallery</h3>
      <span class="text-[10px] font-medium text-[#89B0AE]" x-text="images.length + ' / 12'"></span>
    </div>
    <div class="grid md:grid-cols-5 gap-4">
      <div class="md:col-span-2 flex flex-col gap-3">
        <div class="relative border-2 border-dashed rounded-xl p-5 flex flex-col items-center justify-center text-center gap-3 bg-gradient-to-br from-[#F6FBFA] to-white group transition cursor-pointer overflow-hidden" :class="drag ? 'border-[#116466] ring-2 ring-[#116466]/40 shadow-md' : 'border-[#BEE3DB]'" @click="$refs.galFile.click()" @dragover.prevent="drag=true" @dragleave.prevent="drag=false" @drop.prevent="onDrop($event)">
          <!-- Soft background effect (kept subtle on hover) -->
          <div class="absolute inset-0 pointer-events-none z-0 opacity-40 group-hover:opacity-60 transition duration-300 bg-[radial-gradient(circle_at_28%_30%,#E5F4F299,transparent_65%),radial-gradient(circle_at_80%_78%,#BEE3DB55,transparent_70%)]"></div>
          <!-- Foreground content wrapper ensures text stays above -->
          <div class="relative z-10 flex flex-col items-center justify-center gap-3">
            <svg class="w-9 h-9 text-[#116466] drop-shadow-sm" fill="none" stroke="currentColor" stroke-width="1.6" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3 15a4 4 0 0 1 4-4h1.26a8 8 0 1 1 7.48 5.5H17a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Zm8-5v6m0 0 2-2m-2 2-2-2"/></svg>
            <p class="text-[11px] leading-snug text-[#2e4a49] font-medium"><span class="hidden sm:inline">Drag & Drop</span><span class="sm:hidden">Tap</span> or <span class="text-[#116466] underline">Browse</span><br/><span class="font-normal text-[#89B0AE]">JPG / PNG up to 5MB</span></p>
            <div class="flex gap-2">
              <button type="button" class="px-2.5 py-1.5 rounded-full text-[10px] font-semibold bg-[#116466] text-white hover:bg-[#0d4c4d] shadow" @click.stop="$refs.galFile.click()">Choose File</button>
              <button type="button" class="px-2.5 py-1.5 rounded-full text-[10px] font-semibold bg-white ring-1 ring-[#BEE3DB] hover:bg-[#E5F4F2]" @click.stop="capturing ? stopCamera() : startCamera()" x-text="capturing ? 'Stop Camera' : 'Use Camera'"></button>
            </div>
            <template x-if="file && !usingSnapshot"><p class="text-[10px] text-[#116466] truncate max-w-[160px]" x-text="file.name"></p></template>
            <template x-if="error"><p class="text-[10px] text-[#9b4d49]" x-text="error"></p></template>
            <template x-if="camError"><p class="text-[10px] text-[#9b4d49]" x-text="camError"></p></template>
          </div>
          <input type="file" x-ref="galFile" accept="image/*" capture="environment" class="hidden" @change="onFile($event)" />
        </div>
        <div x-show="capturing" x-cloak class="relative rounded-lg overflow-hidden ring-1 ring-[#BEE3DB] bg-black/70 flex flex-col items-center gap-2 p-3">
          <video x-ref="camVideo" autoplay playsinline class="w-full rounded-md max-h-64 object-contain bg-black"></video>
          <div class="flex gap-2 pt-1">
            <button type="button" @click="takeSnapshot()" class="px-3 py-1.5 rounded-full bg-[#FF9950] hover:bg-[#ff8833] text-white text-[11px] font-semibold">Capture</button>
            <button type="button" @click="stopCamera()" class="px-3 py-1.5 rounded-full bg-white ring-1 ring-[#BEE3DB] text-[11px] font-medium hover:bg-[#E5F4F2]">Cancel</button>
          </div>
        </div>
        <template x-if="usingSnapshot && snapshotData">
          <div class="relative rounded-lg overflow-hidden ring-1 ring-[#116466] bg-white flex flex-col items-center gap-2 p-3">
            <img :src="snapshotData" alt="Snapshot preview" class="w-full max-h-64 object-contain" />
            <div class="flex gap-2">
              <button type="button" @click="upload()" :disabled="uploading" class="px-3 py-1.5 rounded-full bg-[#116466] text-white text-[11px] font-semibold hover:bg-[#0d4c4d] disabled:opacity-40">Upload Snapshot</button>
              <button type="button" @click="retake()" class="px-3 py-1.5 rounded-full bg-white ring-1 ring-[#BEE3DB] text-[11px] font-medium hover:bg-[#E5F4F2]">Retake</button>
              <button type="button" @click="discardSnapshot()" class="px-3 py-1.5 rounded-full bg-[#FFE8E5] text-[#9b4d49] text-[11px] font-medium hover:bg-[#FFD5CF]">Discard</button>
            </div>
          </div>
        </template>
        <input type="text" x-model="caption" maxlength="80" placeholder="Caption (optional)" class="w-full rounded-md border border-[#BEE3DB] bg-white px-2 py-1.5 text-[12px] focus:border-[#116466] focus:ring-[#116466]" />
        <label class="inline-flex items-center gap-2 text-[11px] text-[#555B6E]"><input type="checkbox" x-model="is_primary" class="accent-[#116466]"/> Primary Image</label>
        <div class="flex gap-2 pt-1">
          <button type="button" @click="upload()" :disabled="uploading || !file" class="px-3 py-1.5 rounded-full text-[11px] font-semibold bg-[#116466] text-white disabled:opacity-40 disabled:cursor-not-allowed hover:bg-[#0d4c4d]">Upload</button>
          <button type="button" @click="reset()" :disabled="uploading || !file" class="px-3 py-1.5 rounded-full text-[11px] font-medium bg-white ring-1 ring-[#BEE3DB] hover:bg-[#E5F4F2] disabled:opacity-30">Clear</button>
        </div>
        <template x-if="uploading"><div class="h-1 w-full bg-[#E5F4F2] rounded overflow-hidden"><div class="h-full bg-[#FF9950] animate-pulse" style="width:100%"></div></div></template>
      </div>
      <div class="md:col-span-3">
        <template x-if="!images.length"><p class="text-[11px] italic text-[#89B0AE]">No images yet. Upload your first.</p></template>
        <div class="grid grid-cols-3 gap-2" x-show="images.length">
          <template x-for="img in images" :key="img.id || img.url">
            <div class="relative group border rounded-lg overflow-hidden bg-white ring-1 ring-[#BEE3DB]/70">
              <img :src="img.url" class="w-full h-24 object-cover" :alt="img.caption" />
              <div class="absolute inset-0 bg-black/0 group-hover:bg-black/25 transition"></div>
              <div class="absolute top-1 left-1 flex gap-1">
                <span x-show="img.is_primary" class="px-1.5 py-0.5 rounded bg-[#116466] text-white text-[9px] font-semibold">Primary</span>
              </div>
              <div class="absolute top-1 right-1 flex gap-1 opacity-0 group-hover:opacity-100 transition">
                <button type="button" @click="setPrimary(img)" x-show="!img.is_primary" class="px-1.5 py-0.5 rounded bg-white text-[9px] font-semibold text-[#116466] ring-1 ring-[#BEE3DB] hover:bg-[#E5F4F2]">Primary</button>
                <button type="button" @click.stop.prevent="openDelete(img)" class="px-1.5 py-0.5 rounded bg-[#FFE8E5] text-[9px] font-semibold text-[#9b4d49] hover:bg-[#FFD5CF]">Del</button>
              </div>
              <div class="p-1">
                <input type="text" x-model="img.caption" @change="saveMeta(img)" maxlength="60" placeholder="Caption" class="w-full bg-white/80 rounded border border-[#BEE3DB] px-1 py-0.5 text-[10px] focus:border-[#116466] focus:ring-[#116466]" />
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>
    <!-- Delete Confirmation Modal (correctly inside galleryManager scope) -->
    <div x-show="confirm.show" x-cloak x-trap.noscroll="confirm.show" class="fixed inset-0 z-[120] flex items-center justify-center" data-gallery-delete-modal @keydown.enter.prevent="!confirm.deleting && confirmDeleteAction()" @keydown.escape.stop.prevent="cancelDelete()">
      <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" @click="cancelDelete()"></div>
      <div class="relative w-[360px] max-w-[92%] bg-white rounded-2xl shadow-xl ring-2 ring-[#BEE3DB] p-5 flex flex-col gap-4 focus:outline-none" role="dialog" aria-modal="true" aria-labelledby="gallery-del-title">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-full bg-[#FFE8E5] flex items-center justify-center text-[#9b4d49] shrink-0">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.7" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v4m0 4h.01M5.07 19h13.86c1.54 0 2.5-1.67 1.73-3L13.73 4c-.77-1.33-2.69-1.33-3.46 0L3.34 16c-.77 1.33.19 3 1.73 3Z"/></svg>
          </div>
          <div class="flex flex-col">
            <h4 id="gallery-del-title" class="text-sm font-semibold text-[#555B6E] tracking-wide">Delete image?</h4>
            <p class="text-[11px] text-[#556] leading-snug">This will permanently remove the image and its caption. This action cannot be undone.</p>
            <template x-if="confirm.error"><p class="text-[11px] text-[#9b4d49] mt-1" x-text="confirm.error"></p></template>
          </div>
        </div>
        <div class="flex items-center justify-end gap-2 pt-1">
          <button type="button" @click="cancelDelete()" :class="confirm.deleting ? 'pointer-events-none opacity-40' : ''" class="px-3 py-1.5 rounded-full text-[11px] font-medium bg-white ring-1 ring-[#BEE3DB] hover:bg-[#E5F4F2]">Cancel</button>
          <button type="button" @click="confirmDeleteAction()" :class="confirm.deleting ? 'pointer-events-none opacity-40' : ''" class="px-3 py-1.5 rounded-full text-[11px] font-semibold bg-[#9b4d49] text-white hover:bg-[#873f3b] flex items-center gap-1">
            <svg x-show="!confirm.deleting" class="w-3.5 h-3.5" fill="none" stroke="currentColor" stroke-width="1.8" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 6h12m-9 0v-.5A1.5 1.5 0 0 1 10.5 4h3A1.5 1.5 0 0 1 15 5.5V6m0 0 1 12.5A2 2 0 0 1 14 21H10a2 2 0 0 1-2-2.5L9 6"/></svg>
            <svg x-show="confirm.deleting" class="w-3.5 h-3.5 animate-spin" viewBox="0 0 24 24" fill="none"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="#fff" stroke-width="3"></circle><path class="opacity-90" fill="#fff" d="M4 12a8 8 0 0 1 8-8v3.5A4.5 4.5 0 0 0 7.5 12H4Z"/></svg>
            <span x-text="confirm.deleting ? 'Deleting…' : 'Delete'"></span>
          </button>
        </div>
      </div>
    </div>
  </div>
  {% else %}
  <template x-if="$store.profileModal.therapist.gallery_images && $store.profileModal.therapist.gallery_images.length">
    <div class="mb-10" x-data="{ hover:false }">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-sm font-bold tracking-wide text-[#555B6E]">My Images</h3>
        <span class="text-[10px] font-medium text-[#89B0AE]" x-text="$store.profileModal.therapist.gallery_images.length + ' image' + ($store.profileModal.therapist.gallery_images.length===1?'':'s')"></span>
      </div>
      <div class="grid grid-cols-3 md:grid-cols-6 gap-2 md:gap-3" data-gallery>
        <template x-for="(g,i) in $store.profileModal.therapist.gallery_images" :key="g.url || i">
          <figure class="group relative overflow-hidden rounded-xl ring-1 ring-[#BEE3DB] bg-white/60 backdrop-blur-sm shadow-sm hover:shadow-lg transition-all cursor-zoom-in" :class="g.is_primary ? 'col-span-3 md:col-span-3 row-span-2' : 'col-span-1'" data-lightbox-image @click="($store.mediaLightbox ? $store.mediaLightbox.openImage(g.url) : ($store.profileModal.lightboxImage=g.url))" tabindex="0" @keydown.enter.prevent="($store.mediaLightbox ? $store.mediaLightbox.openImage(g.url) : ($store.profileModal.lightboxImage=g.url))">
            <div class="w-full overflow-hidden flex items-center justify-center bg-[#F6FBFA]" :class="g.is_primary ? 'aspect-[4/3] md:aspect-[16/10]' : 'aspect-[4/3]'">
              <img :src="g.url" :alt="g.caption || 'Gallery image'" loading="lazy" class="w-full h-full object-cover will-change-transform transition duration-500 ease-out group-hover:scale-105 group-focus:scale-105" />
            </div>
            <div class="pointer-events-none absolute inset-0 flex flex-col justify-end">
              <div class="opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity duration-300 bg-gradient-to-t from-black/55 via-black/20 to-transparent p-2 md:p-2.5">
                <div class="flex items-center gap-2">
                  <span x-show="g.is_primary" class="px-1.5 py-0.5 rounded-md bg-[#116466] text-white text-[9px] font-semibold tracking-wide shadow">PRIMARY</span>
                  <p x-show="g.caption" x-text="g.caption" class="text-[11px] leading-tight text-white font-medium line-clamp-2"></p>
                </div>
              </div>
            </div>
            <div class="absolute inset-0 rounded-xl ring-2 ring-offset-2 ring-[#116466] opacity-0 group-focus:opacity-100 transition"></div>
          </figure>
        </template>
      </div>
    </div>
  </template>
  {% endif %}
  </div>
<!-- Personal Statement 2 (styled like Therapy Types Note) -->
<div x-show="editable || $store.profileModal.therapist.personal_statement_q2" x-cloak>
  <div class="mb-4" data-edit-wrapper data-field="personal_statement_q2">
    <div class="relative">
      <template x-if="$store.profileModal.therapist.personal_statement_q2">
        <div class="text-sm md:text-[15px] leading-relaxed font-light text-[#2e4a49] whitespace-pre-line bg-white/70 rounded-xl border border-[#BEE3DB] p-4 pr-10" x-html="$store.profileModal.therapist.personal_statement_q2"></div>
      </template>
      <template x-if="!$store.profileModal.therapist.personal_statement_q2">
        <div>
          <button type="button" x-show="editable" @click.stop="$dispatch('edit-rich-text',{field:'personal_statement_q2',current:'', el:$el})" class="w-full text-left group">
            <div class="p-4 rounded-lg border-2 border-dashed border-[#BEE3DB] bg-white/40 hover:bg-white/70 transition">
              <p class="text-[12px] text-[#89B0AE] group-hover:text-[#555B6E]">Who you help and common concerns/populations. (120–400 chars)</p>
            </div>
          </button>
          <p x-show="!editable" class="italic text-[12px] text-[#89B0AE]">No personal statement.</p>
        </div>
      </template>
      {% if editable %}
      <button type="button" class="absolute top-2 right-2 text-[10px] font-semibold px-2 py-0.5 rounded-full bg-[#E5F4F2] text-[#116466] ring-1 ring-[#BEE3DB] hover:bg-white" @click.stop="$dispatch('edit-rich-text',{field:'personal_statement_q2',current:$store.profileModal.therapist.personal_statement_q2||'', el: $el})">Edit</button>
      {% endif %}
    </div>
  </div>
</div>
<!-- Personal Statement 3 (styled like Therapy Types Note) -->
<div x-show="editable || $store.profileModal.therapist.personal_statement_q3" x-cloak>
  <div class="mb-4" data-edit-wrapper data-field="personal_statement_q3">
    <div class="relative">
      <template x-if="$store.profileModal.therapist.personal_statement_q3">
        <div class="text-sm md:text-[15px] leading-relaxed font-light text-[#2e4a49] whitespace-pre-line bg-white/70 rounded-xl border border-[#BEE3DB] p-4 pr-10" x-html="$store.profileModal.therapist.personal_statement_q3"></div>
      </template>
      <template x-if="!$store.profileModal.therapist.personal_statement_q3">
        <div>
          <button type="button" x-show="editable" @click.stop="$dispatch('edit-rich-text',{field:'personal_statement_q3',current:'', el:$el})" class="w-full text-left group">
            <div class="p-4 rounded-lg border-2 border-dashed border-[#BEE3DB] bg-white/40 hover:bg-white/70 transition">
              <p class="text-[12px] text-[#89B0AE] group-hover:text-[#555B6E]">Your values/philosophy and an invitation to connect. (120–400 chars)</p>
            </div>
          </button>
          <p x-show="!editable" class="italic text-[12px] text-[#89B0AE]">No personal statement.</p>
        </div>
      </template>
      {% if editable %}
      <button type="button" class="absolute top-2 right-2 text-[10px] font-semibold px-2 py-0.5 rounded-full bg-[#E5F4F2] text-[#116466] ring-1 ring-[#BEE3DB] hover:bg-white" @click.stop="$dispatch('edit-rich-text',{field:'personal_statement_q3',current:$store.profileModal.therapist.personal_statement_q3||'', el: $el})">Edit</button>
      {% endif %}
    </div>
  </div>
</div>
<!-- Personal Statement 3 (modal fifth) -->
